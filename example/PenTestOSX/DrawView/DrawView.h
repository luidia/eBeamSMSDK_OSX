//
//  DrawView.h
//  PenTestOSX
//
//  Created by Luidia on 2019
//  Copyright © 2019년 Luidia. All rights reserved.
//

#import <Cocoa/Cocoa.h>

@interface DrawView : NSView
{
    CGContextRef        m_CtxMain;
    CGLayerRef          m_LyrMain;
    CGContextRef        m_CtxLyr;
    
    CGPoint             m_ptOld;
    CGPoint             m_ptNew;
    
    int                 m_nPointCnt;
    NSMutableArray      *m_Points;
    
    NSMutableArray* figureList;
    NSMutableArray* strokeList;
    
    CGContextRef	cgContextBitmap;
	CGContextRef	cgContextMain;
	CGLayerRef		cgLayer;
	CGLayerRef		m_MainLayer;
	CGContextRef	cgContextLayer;
	CGImageRef      m_ImageRef;
    
    CGRect			m_rectMain;
    float           m_nPenThick;
    
    CGRect rtRender;
    int nRenderedIdx;
    int	nDrawingPoint;
    
    BOOL isWrite;
    
    NSColor			*m_PenColor;
    
    CGPoint initOffset;
    CGPoint startOffset;
    
    int curThresholdValue;
    BOOL downFlag;
    BOOL initFlag;
}
@property (readwrite) int nRenderedIdx;
@property (readwrite) int nDrawingPoint;
@property (readwrite) CGRect rtRender;
@property (retain) NSMutableArray* figureList;
@property (retain) NSMutableArray* strokeList;
@property (readonly) BOOL isWrite;

-(void) clear;

-(void) DoMouseDown:(CGPoint) p pressure:(int)pressure;
-(void) DoMouseMove:(CGPoint) p pressure:(int)pressure;
-(void) DoMouseUp:(CGPoint) p pressure:(int)pressure;

-(void) changeDrawingSize;

-(void) DoPenProcess:(int) penTip pressure:(int)pressure X:(float) x Y:(float) y color:(NSColor*)color erase:(BOOL)erase eraseSize:(float)eraseSize;
@end
